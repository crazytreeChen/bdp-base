<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.platform.finance.report.repo.mapper.FinanceResidualPrincipalDistributionReportMapper">
  <!--查询公用字段-->
  <sql id="Query_Pub_Select_List">
    SELECT
     frpdr.channel_type channelType,
     frpdr.channel_name channelName,
     frpdr.product_type productType,
     frpdr.product_child_type productChildType,
     frpdr.principal_amount principalAmount,
     frpdr.normal_principal_amount normalPrincipalAmount,
     frpdr.follow_principal_amount followPrincipalAmount,
     frpdr.secondary_principal_amount secondaryPrincipalAmount,
     frpdr.suspicious_principal_amount suspiciousPrincipalAmount,
     frpdr.loss_principal_amount lossPrincipalAmount,
     frpdr.normal_principal_amount+frpdr.follow_principal_amount+frpdr.secondary_principal_amount+frpdr.suspicious_principal_amount+frpdr.loss_principal_amount AS subTotalAmount,
     frpdr.principal_amount+frpdr.normal_principal_amount+frpdr.follow_principal_amount+frpdr.secondary_principal_amount+frpdr.suspicious_principal_amount+frpdr.loss_principal_amount AS totalAmount
    FROM
    finance_residual_principal_distribution_report frpdr
  </sql>

  <!--查询公用条件-->
  <sql id="Where_Pub_Column">
    <where>
      1=1
      <if test="list.dataDate != null and list.dataDate !=''">
        AND frpdr.data_date = #{list.dataDate}
      </if>
    </where>
  </sql>

  <!--分页查询剩余本金分布表-->
  <select id="selectResidualPrincipalDistributionReport"  resultType="com.platform.finance.report.repo.ro.FinanceResidualPrincipalDistributionReportListRO">
    <include refid="Query_Pub_Select_List"/>
    <include refid="Where_Pub_Column"/>
  </select>

  <!--导出剩余本金分布表-->
  <select id="exportResidualPrincipalDistributionReport"  resultType="com.platform.finance.report.repo.ro.FinanceResidualPrincipalDistributionReportListRO">
    <include refid="Query_Pub_Select_List"/>
    <include refid="Where_Pub_Column"/>
  </select>
</mapper>